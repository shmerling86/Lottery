<my-navbar></my-navbar>

<section>

    <div class="container ">
        <div class="row">

            <div class="col-sm-10 text-center mx-auto m-3">
                <div class="float-right">
                    <i class="fas fa-filter mx-2 d-inline-block " ng-model='isHover' ng-mouseover='isHover = true' ng-mouseleave='isHover=false'
                        title="סנן">

                        <div class="text-center d-inline-block" ng-show='isHover'>

                            <input type="button" style="font-size:0.8rem;" class="btn btn-outline-muted btn-sm "
                                ng-class="{'active':taskfilters == 1}" ng-click="kindOfSort = 'all';taskfilters = 1"
                                value="הכל">

                            <input type="button" style="font-size:0.8rem;" class="btn btn-outline-muted btn-sm" ng-init="taskfilters = 0"
                                ng-class="{'active':taskfilters == 0}" ng-click="kindOfSort = 'active';taskfilters = 0"
                                value="פעיל">

                            <input type="button" style="font-size:0.8rem;" class="btn btn-outline-muted btn-sm"
                                ng-class="{'active':taskfilters == 2}" ng-click="kindOfSort = 'completed';taskfilters = 2"
                                value="הסתיים">
                        </div>
                    </i>
                </div>
                <div class="float-left">
                    <i class="fas fa-bell mx-2 btn " title="הודעות" ng-click="toggleCustom()" style="font-size:1.25rem;position: relative;">
                        <div ng-show="participation>0" class="numOfMsg">{{participation}}</div>
                    </i>

                    <a ng-href="#!/new">
                        <i class="fas fa-plus-circle mx-2 " title="חדש"></i>
                    </a>
                </div>

            </div>
        </div>
    </div>

    <div class="container">
        <div class="row">
            <div class="col-sm-12">

                <div class="notificationBox">
                    <div class="list-group text-right ">


                        <li class="list-group-item shadow bg-white" ng-hide="custom" ng-repeat="participation in participations">
                            <span class="text-left text-muted" style="font-size: 0.6rem">{{participation.joinDate}}</span>
                            <span class="text-right mr-3 d-block" style="font-size: 0.7rem">
                                הצטרפת להגרלה על
                                {{participation.lotteryN}}.</span>
                        </li>
                        <span ng-click="custom=true" ng-hide="custom" class="my-1 text-center float-center font-weight-bold close-btn">X</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="container">
        <div class="row mt-1">
            <div class="col-sm-10 mx-auto text-center mt-2">
                <div class="accordion" id="accordionExample">
                    <div class="card" ng-repeat="lotterie in lotteries | filter : sortByStatus" style="background-color: #393e46; color:#eeeeee">
                        <div class="card-header" id="{{lotterie.productName}}">

                            <h5 class="mb-0">
                                <span class="float-left text-danger" ng-show="{{lotterie.chance}} >= 0.1 && {{lotterie.chance}} <= 0.5">
                                    <i class="fas fa-dice-two my-2" style="font-size:1.8rem;"></i></span>
                                <span class="float-left text-warning" ng-show="{{lotterie.chance}} > 0.5 && {{lotterie.chance}} < 10">
                                    <i class="fas fa-dice-four my-2" style="font-size:1.8rem;"></i>
                                </span>
                                <span class="float-left text-success" ng-show="{{lotterie.chance}} >= 10 && {{lotterie.chance}} <= 50">
                                    <i class="fas fa-dice-six my-2" style="font-size:1.8rem;"></i></span>


                                <!-- <i ng-click='deleteFromLotteries($index)' ng-show={{lotterie.sellerUserId}}=={{userId}} class="far fa-trash-alt float-right my-2" style="color:rgb(255, 0, 0)"></i> -->
                                <button class="btn btn-link" type="button" data-toggle="collapse" data-target="#{{lotterie.id}}"
                                    aria-expanded="false" aria-controls="{{lotterie.id}}" style=" color:#eeeeee">{{lotterie.productName}}
                                </button>
                            </h5>
                        </div>

                        <div id="{{lotterie.id}}" class="collapse" aria-labelledby="{{lotterie.productName}}"
                            data-parent="#accordionExample">

                            <div class="card-body mb-1">
                                <div class="row">

                                    <div class="col-sm-3 font-weight-bold text-right py-2">תיאור המוצר:

                                        <div class="font-weight-normal text-right" style="font-size:0.8rem;">{{lotterie.description}}</div>

                                    </div>

                                    <div class="col-sm-3 font-weight-bold text-right py-2">דמי השתתפות:

                                        <div class="font-weight-normal text-right" style="font-size:0.8rem;">{{lotterie.lotteriePrice
                                            |
                                            number}}
                                            ש"ח
                                        </div>
                                    </div>
                                    <div class="col-sm-3 font-weight-bold text-right py-2">אחוזי זכייה:
                                        <div style="font-size:0.8rem;" class="font-weight-normal text-right">%
                                            {{lotterie.chance}}</div>

                                    </div>
                                    <div class="col-sm-12 mx-auto mt-5" ng-show='{{lotterie.complete}}==100'>
                                        <div class="alert alert-danger" role="alert">
                                            <strong>ההגרלה הסתיימה! </strong>לא ניתן להצטרף להגרלה זו.
                                        </div>
                                    </div>



                                </div>


                                <div class="col-sm-12 mt-5 text-left" ng-hide='{{lotterie.complete}}==100'>

                                    <button type="button" class="btn btn-info font-weight-bold " data-toggle="modal"
                                        data-target=".{{lotterie.id}}" ng-click="getAndCount($event, this.$index);">הצטרף</button>

                                    <div class="text-muted" style="font-size: 0.8rem;">{{lotterie.complete}}%
                                        משתתפים</div>

                                </div>


                            </div>
                        </div>

                        <!-- Modal -->
                        <div class="modal fade {{lotterie.id}}" tabindex="-1" role="dialog" aria-hidden="true">
                            <div class="modal-dialog modal-dialog-centered" role="document">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <h5 class="modal-title">{{lotterie.productName}}</h5>
                                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                        </button>
                                    </div>
                                    <div class="modal-body">
                                        <span class="text-muted">האם אתה בטוח שאתה רוצה להשתתף בהגרלה על</span>
                                        <span class="text-muted"> {{lotterie.productName}} במחיר
                                            {{lotterie.lotteriePrice | number}} ש"ח?</span>
                                        <p></p>
                                    </div>
                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-secondary mx-1  btn-sm" data-dismiss="modal">ביטול</button>
                                        <button type="button" class="btn btn-info  btn-sm" data-dismiss="modal">אישור
                                            ותשלום</button>
                                    </div>
                                </div>
                            </div>
                        </div>


                    </div>
                </div>
            </div>
        </div>

    </div>

    <div class="card-footer bg-dark fixed-bottom text-muted text-center py-1" style="font-size: 0.8rem">
        CODED BY LIOR-SHMERLING
    </div>

</section>